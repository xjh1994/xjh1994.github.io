---
author: xjh1994
comments: true
date: 2013-04-22 11:28:54+00:00
layout: post
slug: '%e3%80%90%e6%96%b0%e5%a2%9e%e7%ae%a1%e7%90%86%e5%8a%9f%e8%83%bd%e3%80%91php%e7%95%99%e8%a8%80%e6%9c%ac'
title: 【新增管理功能】PHP留言本
wordpress_id: 86
categories:
- PHP&amp;MySQL
- 编程
tags:
- PHP留言本
---




## 工具/原料





DW EditPlus


php、mysql服务器







## 步骤/方法


















首先在sql中字节。


























ALTERTABLE`content`ADD`reply`VARCHAR(200)CHARACTERSETutf8COLLATEutf8_general_ciNOTNULLAFTER`content`


























一. 新建login.php















[php]
<html xmlns="http://www.w3.org/1999/xhtml">

<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<title>无标题文档</title>

</head>

<body><table width="678" align="center">

<tr>

<td colspan="2"><h1>留言本</h1></td>

</tr>

<tr>

<td width="586"><a href="index.php">首页</a> | <a href="liuyan.php">留言</a></td>

</tr>

</table>

<table align="center" width="678">

<tr>

<td align="center">

<form name="form1" method="post" action="login2.php">

<label for="textfield"></label>

<p>&nbsp;</p>

<p>帐号：

<input type="text" name="name" id="name">

</p>

<p>密码：

<input type="password" name="pw" id="pw">

</p>

<p>

<input type="submit" name="button" id="button" value="提交">

<input type="reset" name="button2" id="button2" value="重置">

</p>

</form></td>

</tr>

</table>

</body>

</html>
[/php]







header("content-Type: text/html; charset=utf-8");























$name = $_POST['name'];


























$pw = $_POST['pw'];


























if($name == "admin" && $pw == "admin"){


























$_SESSION["adminname"] = $name;


























echo "<script>alert('登录完成，返回首页!');location.href='index.php';</script>";


























}else{


























echo "<script>alert('错误!');location.href='login.php';</script>";


























}


























?>


























三. 在原有的index.php上添加


























<?php


























session_start();


























include("config.php");


























$sql = "select * from content";


























$resule = mysql_query($sql,$q);


























?>


























<html>


























<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />


























<body>


























<table width="678" align="center">


























<tr>


























<td colspan="2"><h1>留言本</h1></td>


























</tr>


























<tr>


























<td width="586"><a href="index.php">首页</a> | <a href="liuyan.php">留言</a></td>


























<td width="80">


























// 新增管理员登录


























<?php


























if (isset($_SESSION['adminname']) && $_SESSION["adminname"] == "admin"){


























echo "<a href='logout.php'>登出</a>";


























}else{


























echo "<a href='login.php'>管理员登录</a>";


























}


























?>


























</td>


























</tr>


























</table>


























<p>


























<?


























while($row=mysql_fetch_array($resule))


























{


























?>


























</p>


























<table width="678" border="1" align="center" cellpadding="1" cellspacing="1">


























<tr>


























<td width="178">Name:<? echo $row[1] ?></td>


























<td width="223">Email:<? echo $row[2] ?></td>


























<td width="100">


























<?php


























if(isset($_SESSION['adminname']) && $_SESSION["adminname"] == "admin"){


























echo "<a href='huifu.php?id=" . $row[0] . "'>回复</a>";


























echo " | " . "<a href='delete.php?id=" . $row[0] . "'>删除</a>";


























} else {


























echo "";


























}


























?>


























</td>


























</tr>


























<tr>


























<td colspan="4"><? echo $row[3] ?></td>


























</tr>


























<tr>


























<td colspan="4"><?


























if($row[4] == ""){


























?>


























<? echo "暂无回复。";?>


























<? }else {echo "管理员回复：". $row[4]; } ?></td>


























</tr>


























</table>


























<?


























}


























?>


























</body>


























</html>


























四. 新建huifu.php


























<?php


























/* session方式


























session_start();


























$_SESSION["id"]=$_GET["id"];


























*/


























include("config.php");


























$sql = "select * from content where id=".$_GET["id"];


























$resule = mysql_query($sql,$q);


























/* cookie方式 */


























SetCookie("id",$_GET["id"]);


























session_start();


























header("content-Type: text/html; charset=utf-8");


























if(empty($_SESSION["adminname"])){


























exit("<script language='javascript'>alert('您尚未登录后台，或登录已超时，请重新登录！');window.location.href='login.php';</script>");


























}


























?>


























<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


























<html xmlns="http://www.w3.org/1999/xhtml">


























<head>


























<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />


























<title>无标题文档</title>


























</head>


























<body>


























<table width="678" align="center">


























<tr>


























<td colspan="2"><h1>留言本</h1></td>


























</tr>


























<tr>


























<td width="586"><a href="index.php">首页</a> | <a href="liuyan.php">留言</a></td>


























</tr>


























</table>


























<table align="center" width="678">


























<tr>


























<td>


























<form name="reply" method="post" action="reply.php" >


























<p>回复：


























<?


























while($row=mysql_fetch_array($resule))


























{


























echo $row[3];


























}


























?>


























</p>


























<p>


























<textarea name="reply" id="reply" cols="45" rows="5"></textarea>


























</p>


























<p>


























<input type="submit" name="button" id="button" value="回复" />


























<input type="reset" name="button2" id="button2" value="重置" />


























</p>


























</form>


























</td>


























</tr>


























</table>


























</body>


























</html>


























五. reply.php 回复留言提交页面.


























<?


























include("config.php");


























/*


























session_start();


























$id = $_SESSION["id"];


























/* cookie方式 */


























$id = $_COOKIE["id"];


























$sql = "select * from content";


























header("content-Type: text/html; charset=utf-8");


























$patch = $_POST["reply"];


























$reply = str_replace("


























","<br />",$patch);


























$resule = mysql_query("UPDATE `2`.`content` SET `reply` = '$reply' WHERE `content`.`id` ="."$id");


























echo "<script>alert('回复成功!');location.href='index.php';</script>";


























?>


























这样就可以建立出一个简单的管理.管理帐号都是admin 因为只是判别输入的是不是admin 是的话就把值输入进session中.











